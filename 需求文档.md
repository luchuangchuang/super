# Vue.js编写移动webApp（移动端点餐页面）

## vue.js介绍：

###### 		Vue.js是当下很火的一个JavaScript MVVM库，它是以数据驱动和组件化的思想构建的。相比于Angular.js，Vue.js提供了更加简洁、更易于理解的API，使得我们能够快速地上手并使用Vue.js。	本次项目严格按照上线外卖App标准来进行开发，我们会从项目的需求分析、脚手架工具（vue-cli）、数据mock、架构设计、代码编写、自测、编译打包等。



#### 	项目亮点是以线上代码项目来要求：	



###### 			|---代码开发及测试环节	

###### 							|---完美还原ui设计图

###### 							|---以真实外卖App数据做演示，以保证代码无兼容性问题

###### 			|---代码规范

###### 							|---架构设计

###### 							|---组件抽象

###### 							|---模块拆分

###### 							|---代码风格统一

###### 							|---JS、CSS代码书写以及命名规范

##### 	致力于编写高可维护、易于扩展、可维护性强的代码，让同学们了解真实互联网公司是如何开发前端项目的。

![页面功能](./img/GIF.gif)



## 一、准备工作

#### 	技术栈:html5、css3、Javascript、es6、npm、vue.js



## 二、初始化项目

###### 	1. 初始化项目

```javascript
	vue init webpack sell
    cd sell
    cnpm install
    npm run dev
    注：ESLint是用来统一代码规范和风格的工具，如缩进、空格、符号等，要求比较严格，初学者可以不使用，可在init的时候选择关闭。
```



###### 	2. 项目资源准备

​      |-resource

        |-效果	
        |-标注
        |-imgs
        |-iconfont	字体图库
        |-PSD
        |-common.js	使用rem进行移动端适配
        |-reset.css 重置浏览器标签默认样式的css


###### 	3.创建目录结构

```
//首先清除原项目中部分内容
删除assets目录
删除Hello.vue组件
```
创建如下目录结构
```
|-resource  //非必须，主要是为了方便查看
 	|-效果	
    |-标注
    |-imgs
    |-iconfont	
    |-PSD
    |-common.js	
    |-reset.css 
|-src     
    |-components
        |-header    //将某个组件相关资源都放到同一目录下，便于管理和维护
            |-header.vue
        |-goods
            |-goods.vue    
        |-ratings
            |-ratings.vue
        |-seller
            |-seller.vue
            |-decrease.png
            |-discount.png
        ....
    |-imgs
    |-router
    	|-index.js
    |-App.vue
    |-main.js
|-static
    |-css
        |-reset.css 
    |-iconfont
    |-js
    	|-common.js
    |-less				//通用的less文件
|-babelrc
|-editorconfig
|-gitignore
|-data.json     		//模拟数据，修改此文件后需要重启服务才生效
|-index.html
|-package.json
|-README.md
```


###### 	4.配置API接口



    使用express框架启动一个Node服务器，配置API接口，模拟后台数据  
    编辑build/dev-server.js文件，添加如下内容：
    
    var appData = require('../data.json');//获取数据
    
    var seller = appData.seller;
    var goods = appData.goods;
    var ratings = appData.ratings;
    
    var apiRouters = express.Router();//定义路由
    
    apiRouters.get('/seller',function(req,res){
      //返回接口
      res.json({
        //我们开发规范都会再返回接口的时候给一个errno
        //errno为0表示请求数据正常，我们是模拟肯定是正常的
        //如果真实的肯定有各种限制，不一定为0，具体数值
        //根据业务自己去定制的错误码
        errno:0,
        // 下面是具体的数据 
        data:seller
      });
    });
    
    apiRouters.get('/goods',function(req,res){
      res.json({
        errno:0,
        data:goods
      });
    });
    
    apiRouters.get('/ratings',function(req,res){
      res.json({
        errno:0,
        data:ratings
      });
    });
    
    app.use('/api',apiRouters);
    
    在浏览器中访问：
                http://localhost:8080/api/seller
                http://localhost:8080/api/goods
                http://localhost:8080/api/ratings
            注：可以使用Chrome的JSONView插件查看JSON数据，格式更易阅读  

## 三、项目整体结构开发

#### 	1.项目结构拆分

```javas
编辑App.vue
	<v-header :seller = 'seller'></v-header>
	<div class="tab">
    	<div class="tab-item">
      		<router-link to="/goods">商品</router-link>
      	</div>
        <div class="tab-item">
        	<router-link to="/ratings">评论</router-link>
        </div>
        <div class="tab-item">
        	<router-link to="/seller">商家</router-link>
        </div>
	</div>
    <router-view :seller = 'seller'></router-view>
```

#### 	2. 配置vue-router路由

```javas
export default new Router({
	routes: [
    	{
      		path: '/goods',
      		name: 'goods',
     		component: Goods
    	},    
    	{
      		path: '/seller',
      		name: 'seller',
      		component: Seller
    	},    
    	{
      		path: '/ratings',
      		name: 'ratings',
      		component: Ratings
    	},
    	{   // 根目录重定向  
        	path: '/', redirect: '/goods'  
    	},  
  	]
})

```

#### 	3.使用axios发送请求获取商家信息

```javascript
/**
 * 安装其他插件的时候，可以直接在 main.js 中引入并 Vue.use()，但是 axios 并不能 use，只能每个需要发送请求的组件中即时引入
 * 为了解决这个问题，有两种开发思路，一是在引入 axios 之后，修改原型链，二是结合 Vuex，封装一个 aciton。
 * 这时候如果在其它的组件中，是无法使用 axios 命令的。但如果将 axios 改写为 Vue 的原型属性，就能解决这个问题
 * Vue.prototype.$ajax = axios
 */
Vue.prototype.$ajax = axios
//使用示例：
 	this.$ajax.get('/api/seller').then((resp) => {
    	// console.log(resp.data)
    	if( resp.data.errno === 0 ){
      		this.seller = resp.data.data;
      		// console.log(this.seller);
    	}
  	}).catch(function(err){
   		console.log(err);
  	});
```

#### 4.开发header组件

##### 	1.设计header组件

##### 	2.设计star组件

#### 5.开发detail组件

##### 	1.实现弹出层

##### 	2.设计Sticky footers布局

    Sticky footers：
        如果页面内容不够长的时候，页脚块粘贴在视窗底部；如果内容足够长时，页脚块会被内容向下推送。
##### 	3.使用vue.js中的transition完成动画切换效果

#### 6.开发goods商品列表页

##### 	1.左侧menu布局

##### 	2.右侧foods布局

##### 	3.better-scroll的使用

###### 		3.1基本用法

```javas
cnpm install BScroll --save
import BScroll from 'better-scroll'    

initScroll(){
	this.menuScroll=new BScroll(document.getElementsByClassName('menu-wrapper')[0],{
    	click:true //插件默认阻止了事件，需要派发事件才行，这里派发click事件，以便能触发click事件
    });
    this.foodsScroll=new BScroll(document.getElementsByClassName('foods-wrapper')[0],{
    	probeType:3 //派发scroll事件，以便在滚动时能实时获取滚动位置
    });
    //监听滚动事件，当滚动时触发，参数pos表示实时位置
    this.foodsScroll.on('scroll',(pos) => {
    	// console.log(pos.y);
   		this.scrollY=Math.abs(Math.round(pos.y)); //有小数、向下滚动时值为负数
    });
}
```

###### 		3.2实现左右联动

```scrip
calcHeight(){
        let foodList=document.getElementsByClassName('food-list');
        let height=0;
        this.heights.push(height);
        for(let i=0;i<foodList.length;i++){
            height+=foodList[i].clientHeight; //获取每一个区间的高度，然后累加
            this.heights.push(height);
        }
    },
    selectMenu(index){
        // console.log(index);
        let foodList=document.getElementsByClassName('food-list');
        this.foodsScroll.scrollToElement(foodList[index],300); //滚动到指定元素位置
    }
```



#### 7.开发shopcart购物车组件

#### 8.开发cartcontrol组件

#### 9.开发food商品详情页

#### 10.开发评论页面

##### 	1.设计评论选择组件

##### 	2.设计分割线组件

#### 11.开发商家页面























